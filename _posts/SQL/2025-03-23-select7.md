---
layout: post
title:  "[SQL] LV.1 조건에 부합하는 중고거래 댓글 조회하기(SELECT)" 
subtitle: programmers
tags: [Oracle]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/164673>

## 테이블 구조

1. `USED_GOODS_BOARD`테이블
    - `BOARD_ID`: 게시글 ID
    - `WRITER_ID`: 작성자 ID
    - `TITLE`: 게시글 제목
    - `CONTENTS`: 게시글 내용
    - `PRICE`: 가격
    - `CREATED_DATE`: 작성일
    - `STATUS`: 거래상태
    - `VIEWS`: 조회수
2. `USED_GOODS_REPLY`테이블
    - `REPLY_ID`: 댓글 ID
    - `BOARD_ID`: 게시글 ID
    - `WRITER_ID`: 작성자 ID
    - `CONTENTS`: 댓글 내용
    - `CREATE_DATE`: 작성일

## 1. 답안


```sql
SELECT 
    UGB.TITLE, 
    UGB.BOARD_ID, 
    UGR.REPLY_ID, 
    UGR.WRITER_ID, 
    UGR.CONTENTS, 
    TO_CHAR(UGR.CREATED_DATE, 'YYYY-MM-DD') AS CREATED_DATE
FROM USED_GOODS_BOARD UGB
JOIN USED_GOODS_REPLY UGR 
    ON UGB.BOARD_ID = UGR.BOARD_ID
WHERE TO_CHAR(UGB.CREATED_DATE, 'YYYY-MM') = '2022-10'
ORDER BY UGR.CREATED_DATE, UGB.TITLE;
```

## 쿼리 설명

(1) `FROM + JOIN`절


```sql
FROM USED_GOODS_BOARD UGB
JOIN USED_GOODS_REPLY UGR 
    ON UGB.BOARD_ID = UGR.BOARD_ID
```

- 게시글과 댓글을 `BOARD_ID`를 기준으로 내부 조인한다.
- 즉, "댓글이 달린 게시글"에 대해서만 결과를 출력한다.

(2) `WHERE`조건: 2022년 1월 게시글


```sql
WHERE TO_CHAR(UGB.CREATED_DATE, 'YYYY-MM') = '2022-10'
```

- 게시글 작성일(`UGB.CREATED_DATE`)을 `'YYYY-MM'` 형식(예: `'2022-10'`)으로 바꾼 후
- 그 값이 **2022년 10월**인 게시글만 선택한다.
- 즉, "2022년 10월에 작성된 게시글에 달린 댓글만"분석한다.

(3) `SELECT`절: 출력할 정보


```sql
SELECT 
    UGB.TITLE, 
    UGB.BOARD_ID, 
    UGR.REPLY_ID, 
    UGR.WRITER_ID, 
    UGR.CONTENTS, 
    TO_CHAR(UGR.CREATED_DATE, 'YYYY-MM-DD') AS CREATED_DATE
```

- 댓글이 달린 게시글 제목
- 게시글 ID
- 댓글 ID
- 댓글 작성자 ID
- 댓글 내용
- 댓글 작성일을 `'YYYY-MM-DD'`형식으로 포맷팅해서 출력

(4) `ORDER BY`: 정렬 조건


```sql
ORDER BY UGR.CREATED_DATE, UGB.TITLE;
```

- 댓글 작성일 기준으로 오름차순
- 같은 날이면 게시글 제목 오름차순

## 2. 답안(BETWEEN)


```sql
SELECT 
    UGB.TITLE, 
    UGB.BOARD_ID, 
    UGR.REPLY_ID, 
    UGR.WRITER_ID, 
    UGR.CONTENTS, 
    TO_CHAR(UGR.CREATED_DATE, 'YYYY-MM-DD') AS CREATED_DATE
FROM USED_GOODS_BOARD UGB
JOIN USED_GOODS_REPLY UGR 
    ON UGB.BOARD_ID = UGR.BOARD_ID
WHERE UGB.CREATED_DATE BETWEEN TO_DATE('2022-10-01', 'YYYY-MM-DD') 
                          AND TO_DATE('2022-10-31', 'YYYY-MM-DD')
ORDER BY UGR.CREATED_DATE, UGB.TITLE;
```
