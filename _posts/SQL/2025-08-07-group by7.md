---
layout: post
title:  "[SQL] LV.3 조건에 맞는 사용자와 총 거래금액 조회하기(GROUP BY)" 
subtitle: programmers
tags: [Oracle]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/164668>

## 테이블 구조

1. `USED_GOODS_BOARD`테이블
    - `BOARD_ID`: 게시글 ID
    - `WRITER_ID`: 작성자 ID
    - `TITLE`: 게시글 제목
    - `CONTENTS`: 게시글 내용
    - `PRICE`: 가격
    - `CREATE_DATE`: 작성일
    - `STATUS`: 거래상태
    - `VIEWS`: 조회수
2. `USED_GOODS_USER`테이블
    - `USER_ID`: 회원 ID
    - `NICKNAME`: 닉네임
    - `CITY`: 시
    - `STREET_ADDRESS1`: 도로명 주소
    - `STREET_ADDRESS2`: 상세 주소
    - `TLNO`: 전화번호

## 답안


```sql
SELECT UGU.USER_ID, UGU.NICKNAME, SUM(UGB.PRICE) AS TOTAL_SALES
FROM USED_GOODS_BOARD UGB
INNER JOIN USED_GOODS_USER UGU ON UGB.WRITER_ID = UGU.USER_ID
WHERE UGB.STATUS = 'DONE'
GROUP BY UGU.USER_ID, UGU.NICKNAME
HAVING SUM(UGB.PRICE) >= 700000
ORDER BY TOTAL_SALES
```

## 쿼리 설명


```sql
INNER JOIN USED_GOODS_USER UGU ON UGB.WRITER_ID = UGU.USER_ID
```

- 조건이 안 되는 사용자는 제외되며, 두 테이블 모두 일치하는 데이터가 있어야 한다.


```sql
GROUP BY UGU.USER_ID, UGU.NICKNAME
```

- 작성자(`USER_ID`, `NICKNAME`) 기준으로 그룹을 묶는다.


```sql
HAVING SUM(UGB.PRICE) >= 700000
```

- `WHERE`는 그룹핑 전에 조건, `HAVING`은 그룹핑 이후 집계 조건에 사용된다.
