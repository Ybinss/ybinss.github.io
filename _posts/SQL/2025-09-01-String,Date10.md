---
layout: post
title:  "[SQL] LV.3 오랜 기간 보호한 동물(2)(String, Date)" 
subtitle: programmers
tags: [Oracle]
categories: SQL
---

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/59411>

## 테이블 구조

1. `ANIMAL_INS`테이블
    - `ANIMAL_ID`: 동물의 ID
    - `ANIMAL_TYPE`: 생물 종
    - `DATETIME`: 보호 시작일
    - `INTAKE_CONDITION`: 보호 시작 시 상태
    - `NAME`: 이름
    - `SEX_UPON_INTAKE`: 성별 및 중성화 여부
2. `ANIMAL_OUTS`테이블
    - `ANIMAL_ID`: 동물의 ID
    - `ANIMAL_TYPE`: 생물 종
    - `DATETIME`: 입양일
    - `NAME`: 이름
    - `SEX_UPON_OUTCOME`: 성별 및 중성화 여부

## 답안


```sql
SELECT O.ANIMAL_ID, O.NAME
FROM ANIMAL_INS I
JOIN ANIMAL_OUTS O ON I.ANIMAL_ID = O.ANIMAL_ID
ORDER BY DATEDIFF(O.DATETIME, I.DATETIME) DESC
LIMIT 2
```

## 쿼리 설명


```sql
ORDER BY DATEDIFF(O.DATETIME, I.DATETIME) DESC
LIMIT 2
```

- 보호소에 가장 오래 있었던 2마리 확인
