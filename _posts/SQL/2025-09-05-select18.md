---
layout: post
title:  "[SQL] LV.4 오프라인/온라인 판매 데이터 통합하기(SELECT)" 
subtitle: programmers
tags: [MySQL]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />


# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/131537>

## 테이블 구조

1. `ONLINE_SALE`테이블
    - `ONLINE_SALE_ID`: 온라인 상품 판매 ID
    - `USER_ID`: 회원 ID
    - `PRODUCT_ID`: 상품 ID
    - `SALES_AMOUNT`: 판매량
    - `SALES_DATE`: 판매일
2. `OFFLINE_SALE`테이블
    - `OFFLINE_SALE_ID`: 오프라인 상품 판매 ID
    - `PRODUCT_ID`: 상품 판매 ID
    - `SALES_AMOUNT`: 판매량
    - `SALES_DATE`: 판매일

## 답안


```sql
SELECT 
    DATE_FORMAT(SALES_DATE, '%Y-%m-%d') AS SALES_DATE, 
    PRODUCT_ID, 
    USER_ID, 
    SALES_AMOUNT
FROM ONLINE_SALE 
WHERE SALES_DATE >= '2022-03-01' AND SALES_DATE < '2022-04-01'

UNION

SELECT 
    DATE_FORMAT(SALES_DATE, '%Y-%m-%d') AS SALES_DATE, 
    PRODUCT_ID, 
    NULL AS USER_ID, 
    SALES_AMOUNT
FROM OFFLINE_SALE 
WHERE SALES_DATE >= '2022-03-01' AND SALES_DATE < '2022-04-01'

ORDER BY SALES_DATE, PRODUCT_ID, USER_ID
```

## 쿼리 설명


```sql
UNION
```

- 두 SELECT 결과를 합집합으로 결합
- 주의점
    + `UNION`은 기본적으로 중복 제거를 한다.
    + 만약 중복도 포함해서 전부 보고 싶다면 `UNION ALL`을 써야 한다. 
