---
layout: post
title:  "[SQL] LV.4 식품분류별 가장 비싼 식품의 정보 조회하기(GROUP BY)" 
subtitle: programmers
tags: [MySQL]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/131116>

## 테이블 구조

1. `FOOD_PRODUCT`테이블
    - `PRODUCT_ID`: 식품 ID
    - `PRODUCT_NAME`: 식품 이름
    - `PRODUCT_CD`: 식품코드
    - `CATEGORY`: 식품분류
    - `PRICE`: 식품 가격

## 1. 답안


```sql
SELECT CATEGORY, PRICE AS MAX_PRICE, PRODUCT_NAME
FROM FOOD_PRODUCT
WHERE CATEGORY IN ('과자', '국', '김치', '식용유')
    AND PRICE IN (SELECT MAX(PRICE)
                  FROM FOOD_PRODUCT
                  GROUP BY CATEGORY)
ORDER BY MAX_PRICE DESC
```

## 쿼리 설명


```sql
    AND PRICE IN (SELECT MAX(PRICE)
                  FROM FOOD_PRODUCT
                  GROUP BY CATEGORY)
```

- 모든 카테고리별 최대 가격 값들의 집합에 `PRICE`가 포함되면 통과

## 2. 답안


```sql
SELECT CATEGORY, PRICE AS MAX_PRICE, PRODUCT_NAME
FROM FOOD_PRODUCT
WHERE (CATEGORY, PRICE) IN (SELECT CATEGORY, MAX(PRICE)
                            FROM FOOD_PRODUCT
                            GROUP BY CATEGORY
                            HAVING CATEGORY IN ('과자', '국', '김치', '식용유'))
ORDER BY PRICE DESC
```

## 쿼리 설명


```sql
WHERE (CATEGORY, PRICE) IN (SELECT CATEGORY, MAX(PRICE)
                            FROM FOOD_PRODUCT
                            GROUP BY CATEGORY
                            HAVING CATEGORY IN ('과자', '국', '김치', '식용유'))
```

- `WHERE (CATEGORY, PRICE) IN (...)`는 행(튜플) 비교이다.
    + 카테고리도 같고, 동시에 그 카테고리의 최대 가격과 동일한 가격인 행만 통과 


```sql

```
