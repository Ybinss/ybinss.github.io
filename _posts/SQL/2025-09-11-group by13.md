---
layout: post
title:  "[SQL] LV.4 입양 시각 구하기(2)(GROUP BY)" 
subtitle: programmers
tags: [Oracle]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/59413>

## 테이블 구조

1. `ANIMAL_OUTS`테이블
    - `ANIMAL_ID`: 동물의 아이디
    - `ANIMAL_TYPE`: 생물 종
    - `DATETIME`: 입양일
    - `NAME`: 이름
    - `SEX_UPON_OUTCOME`: 성별 및 중성화 여부

## 답안 (세션 변수)


```sql
SET @HOUR = -1;

SELECT (@HOUR := @HOUR + 1) AS HOUR,
    (SELECT COUNT(HOUR(DATETIME))
     FROM ANIMAL_OUTS
     WHERE HOUR(DATETIME) = @HOUR) AS COUNT
     FROM ANIMAL_OUTS
WHERE @HOUR < 23;
```

## 쿼리 설명


```sql
SET @HOUR = -1;
```

- 세션 변수 초기화


```sql
(@HOUR := @HOUR + 1) AS HOUR,
```

- 행을 한 줄 읽을 때마다 `@HOUR`를 1씩 올리고 그 값을 출력한다.
- 외부 `FROM ANIMAL_OUTS`가 스캔되는 동안 `@HOUR`가 0->1->... 증가


```sql
WHERE @HOUR < 23;
```

- `@HOUR`가 23이 될 때까지만 행을 남겨 0~23 총 24행을 만들려는 장치
