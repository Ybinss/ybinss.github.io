---
layout: post
title:  "[SQL] LV.4 주문량이 많은 아이스크림들 조회하기(JOIN)" 
subtitle: programmers
tags: [Oracle]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/133027>

## 테이블 구조

1. `FIRST_HALF`테이블
    - `SHIPMENT_ID`: 출하 번호
    - `FLAVOR`: 아이스크림 맛
    - `TOTAL_ORDER`: 상반기 아이스크림 총주문량
2. `JULY`테이블
    - `SHIPMENT_ID`: 출하 번호
    - `FLAVOR`: 아이스크림 맛
    - `TOTAL_ORDER`: 7월 아이스크림 총주문량

## 1. 답안


```sql
SELECT FH.FLAVOR
FROM FIRST_HALF FH
JOIN JULY J ON FH.FLAVOR = J.FLAVOR
GROUP BY FH.FLAVOR
ORDER BY SUM(FH.TOTAL_ORDER + J.TOTAL_ORDER) DESC
LIMIT 3;
```

## 2. 답안(UNION)


```sql
SELECT A.FLAVOR
FROM (
    SELECT * FROM FIRST_HALF
    UNION
    SELECT * FROM JULY
) AS A
GROUP BY A.FLAVOR
ORDER BY SUM(A.TOTAL_ORDER) DESC
LIMIT 3;
```
