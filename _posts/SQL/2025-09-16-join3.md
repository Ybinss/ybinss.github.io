---
layout: post
title:  "[SQL] LV.4 주문량이 많은 아이스크림들 조회하기(JOIN)" 
subtitle: programmers
tags: [Oracle]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/133027>

## 테이블 구조

1. `FIRST_HALF`테이블
    - `SHIPMENT_ID`: 출하 번호
    - `FLAVOR`: 아이스크림 맛
    - `TOTAL_ORDER`: 상반기 아이스크림 총주문량
2. `JULY`테이블
    - `SHIPMENT_ID`: 출하 번호
    - `FLAVOR`: 아이스크림 맛
    - `TOTAL_ORDER`: 7월 아이스크림 총주문량

## 1. 답안


```sql
SELECT *
FROM (SELECT FH.FLAVOR
      FROM FIRST_HALF FH
      JOIN JULY J ON FH.FLAVOR = J.FLAVOR
      WHERE FH.FLAVOR = J.FLAVOR
      GROUP BY FH.FLAVOR
      ORDER BY SUM(FH.TOTAL_ORDER + J.TOTAL_ORDER) DESC
      )
WHERE ROWNUM <= 3
```

### 쿼리 설명


```sql
ORDER BY SUM(FH.TOTAL_ORDER + J.TOTAL_ORDER) DESC
```

- 각 FLAVOR 그룹에 대해 `FH.TOTAL_ORDER + J.TOTAL_ORDER`를 행 단위로 더한 뒤, `SUM()`으로 합산한 값을 기준으로 내림차순 정렬한다.
