---
layout: post
title:  "[SQL] LV.4 5월 식품들의 총매출 조회하기(JOIN)" 
subtitle: programmers
tags: [MySQL]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/131117>

## 테이블 구조

1. `FOOD_PRODUCT`테이블
    - `PRODUCT_ID`: 식품 ID
    - `PRODUCT_NAME`: 식품 이름
    - `PRODUCT_CD`: 식품코드
    - `CATEGORY`: 식품분류
    - `PRICE`: 식품 가격
2. `FOOD_ORDER`테이블
    - `ORDER_ID`: 주문 ID
    - `PRODUCT_ID`: 제품 ID
    - `AMOUNT`: 주문량
    - `PRODUCE_DATE`: 생산일자
    - `IN_DATE`: 입고일자
    - `OUT_DATE`: 출고일자
    - `FACTORY_ID`: 공장 ID
    - `WAREHOUSE_ID`: 창고 ID

## 답안


```sql
SELECT 
    P.PRODUCT_ID, 
    P.PRODUCT_NAME, 
    SUM(P.PRICE * O.AMOUNT) AS TOTAL_SALES
FROM FOOD_PRODUCT P
JOIN FOOD_ORDER O ON P.PRODUCT_ID = O.PRODUCT_ID
WHERE DATE_FORMAT(O.PRODUCE_DATE, '%Y-%m') = '2022-05'
GROUP BY P.PRODUCT_NAME
ORDER BY TOTAL_SALES DESC, PRODUCT_ID
```

## 쿼리 설명
