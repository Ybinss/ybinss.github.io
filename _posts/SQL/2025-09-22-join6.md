---
layout: post
title:  "[SQL] LV.4 그룰별 조건에 맞는 식당 목록 출력하기(JOIN)" 
subtitle: programmers
tags: [Oracle]
categories: SQL
---
<img width="100%" alt="Image" src="https://github.com/user-attachments/assets/576a3402-5d36-4141-8911-03a2e9c1a015" />

# 문제
<https://school.programmers.co.kr/learn/courses/30/lessons/131124>

## 테이블 구조

1. `MEMBER_PROFILE`테이블
    - `MEMBER_ID`: 회원 ID
    - `MEMBER_NAME`: 회원 이름
    - `TLNO`: 회원 연락처
    - `GENDER`: 성별
    - `DATE_OF_BIRTH`: 생년월일
2. `REST_REVIEW`테이블
    - `REVIEW_ID`: 리뷰 ID
    - `REST_ID`: 식당 ID
    - `MEMBER_ID`: 회원 ID
    - `REVIEW_SCORE`: 점수
    - `REVIEW_TEXT`: 리뷰 텍스트
    - `REVIEW_DATE`: 리뷰 작성일

## 답안


```sql
SELECT 
    M.MEMBER_NAME, 
    R.REVIEW_TEXT, 
    DATE_FORMAT(R.REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE
FROM MEMBER_PROFILE M
JOIN REST_REVIEW R ON M.MEMBER_ID = R.MEMBER_ID
WHERE R.MEMBER_ID = (SELECT MEMBER_ID
                     FROM REST_REVIEW
                     GROUP BY MEMBER_ID
                     ORDER BY COUNT(*) DESC
                     LIMIT 1)
ORDER BY REVIEW_DATE, REVIEW_TEXT
```

## 쿼리 설명


```sql
WHERE R.MEMBER_ID = (SELECT MEMBER_ID
                     FROM REST_REVIEW
                     GROUP BY MEMBER_ID
                     ORDER BY COUNT(*) DESC
                     LIMIT 1)
```

- 리뷰를 가장 많이 작성한 회원의 ID를 찾고, 그 ID와 일치하는 리뷰만 메인 쿼리에서 필터링한다.
